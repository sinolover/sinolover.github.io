<html>
<head>
<script type="text/javascript" async="" src="https://hubble-js-bucket.nosdn.127.net/DATracker.globals.1.6.12.8.js"></script>
<script>function initTheme() {
                const themeMap = {
                    system: 'system',
                    dark: 'dark',
                    light: 'light'
                }
                let theme = localStorage.getItem('note-theme');
                if (!theme || !Object.keys(themeMap).includes(theme)) theme = themeMap.light;
                document.documentElement.classList.add('theme-' + theme);

                if (theme === 'system') {
                    const matchDark = window.matchMedia('(prefers-color-scheme: dark)');
                    window.ynoteTheme = matchDark.matches ? themeMap.dark : themeMap.light;
                } else {
                    window.ynoteTheme = theme;
                }
            }

            const blacklist = ['/#/setting/'];
            const curHref = window.location.href.toLowerCase();
            const canUseTheme = blacklist.every(function (black) {
                return !curHref.includes(black);
            })
            if (canUseTheme) {
                initTheme();
            }</script>
<style>.theme-dark {
                --loadingBg: #202124;
                --loadingText: #afb5bd;
            }
            .theme-light {
                --loadingBg: #ffffff;
                --loadingText: #4e5a70;
            }
            @media (prefers-color-scheme: dark) {
                .theme-system {
                    --loadingBg: #202124;
                    --loadingText: #afb5bd;
                }
            }
            html, body {
                margin: 0;
                padding: 0;
                height: 100%;
                background: var(--loadingBg);
                color: var(--loadingText)
            }</style>
<script>var ua = navigator.userAgent;
            if (ua.toLowerCase().indexOf('applewebkit') < 0) {
                location.href = '/web/unsupport.html';
            }</script>
<style>html{--brand-8:#ebf0ff;--brand-7:#326cfe;--brand-6:#5b89fe;--brand-5:#7098fe;--brand-4:#98b5fe;--brand-3:#c2d3ff;--brand-2:#ebf0ff;--brand-1:#f5f8ff;--line-4:#e1e6ed;--line-3:#e1e6ed;--line-2:#eceff4;--line-1:#f0f3f5;--fill-11:#fff;--fill-10:#fff;--fill-9:#fff;--fill-8:#37435c;--fill-7:#626e85;--fill-6:#939cad;--fill-5:#c0c8d6;--fill-4:#e1e6ed;--fill-3:#f0f3f5;--fill-2:#f4f6f7;--fill-1:#f9fafb;--text-6:#c0c8d6;--text-5:#232d47;--text-4:#4e5a70;--text-3:#7a8599;--text-2:#a9b2c2;--text-1:#c0c8d6;--opacity-6-success-3:rgba(195,236,218,.6);--opacity-6-brand-3:rgba(194,211,255,.6);--opacity-6-text-5:rgba(35,45,71,.6);--success-7:#2b996a;--success-6:#36bf84;--success-5:#72d2a9;--success-4:#9adfc1;--success-3:#c3ecda;--success-2:#ebf9f3;--success-1:#f5fcf9;--warning-7:#cb7428;--warning-6:#fe9132;--warning-5:#feb270;--warning-4:#fec898;--warning-3:#ffdec2;--warning-2:#fff4eb;--warning-1:#fffaf5;--error-7:#bb4343;--error-6:#e95454;--error-5:#f08787;--error-4:#f4aaaa;--error-3:#f9cccc;--error-2:#fdeeee;--error-1:#fef6f6;--o-1:#ffdec2;--o-2:#fec898;--y-1:#ffedc2;--y-2:#fee298}html{--theme-basic:#fff;--input-bg:#fff;--input-bg-dialog:#fff;--brand-hint:var(--brand-2);--searchHistoryHover:#cedcff;--sidebar-hover-selected:var(--fill-3);--dialog-box-shadow:0 1px 16px 0 hsla(0,0%,60%,.4);--file-selector-hover-bg:rgba(0,0,0,.08);--file-selector-selected-bg:rgba(0,0,0,.08)}body,html{background:#fff;background:var(--fill-9);color:#4e5a70;color:var(--text-4)}body,html{width:100%;height:100%;border:none;font-size:14px;font-family:PingFang SC,Source Han Sans,思源黑体,Microsoft Yahei,WenQuanYi Micro Hei,Arial,"sans-serif";line-height:1.5;margin:0;padding:0;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:default}div,img{border:0;margin:0;padding:0}svg:not([fill]){fill:currentColor}#svg-sprite #graph-btn,#svg-sprite #graph-global-btn,#svg-sprite #graph-zoom-in,#svg-sprite #graph-zoom-out{fill:transparent}#svg-sprite #graph-btn [stroke],#svg-sprite #graph-global-btn [stroke],#svg-sprite #graph-zoom-in [stroke],#svg-sprite #graph-zoom-out [stroke]{stroke:currentColor}</style>
<link rel="stylesheet" href="styles.0c01e9903a27d5f25972.css" media="all" onload="this.media='all'">
<noscript><link rel="stylesheet" href="styles.css"></noscript>
<style>.theme-dark[_ngcontent-iyk-c122]{--brand-8: #2d4065;--brand-7: #5e94ff;--brand-6: #4c88ff;--brand-5: #2e65d1;--brand-4: #365491;--brand-3: #2d4066;--brand-2: #293650;--brand-1: #242b3a;--line-4: #3d3d3d;--line-3: #46494d;--line-2: #3f4042;--line-1: #37393b;--fill-11: #46494d;--fill-10: #292a2d;--fill-9: #202124;--fill-8: #e1e3e5;--fill-7: #9aa0a6;--fill-6: #7b7f85;--fill-5: #606367;--fill-4: #46494d;--fill-3: #3a3b3d;--fill-2: #2f3033;--fill-1: #191a1c;--opacity-6-success-3: rgba(38, 80, 65, .6);--opacity-6-brand-3: rgba(45, 64, 102, .6);--opacity-6-text-5: rgba(225, 227, 229, .6);--text-6: #686b70;--text-5: #e1e3e5;--text-4: #afb5bd;--text-3: #9a9fa6;--text-2: #686b70;--text-1: #4c4e52;--success-7: #59c999;--success-6: #47c38e;--success-5: #3b926e;--success-4: #337259;--success-3: #265041;--success-2: #284139;--success-1: #24312f;--warning-7: #feb06b;--warning-6: #fea75b;--warning-5: #bb7f4a;--warning-4: #8f643f;--warning-3: #634935;--warning-2: #4c3c2f;--warning-1: #362e29;--error-7: #ee7474;--error-6: #ec6565;--error-5: #af5151;--error-4: #864344;--error-3: #5d3537;--error-2: #492f31;--error-1: #34282a;--o-1: #8f643f;--o-2: #bb7f4a;--y-1: #635535;--y-2: #8f783f}@media (prefers-color-scheme: dark){.theme-system[_ngcontent-iyk-c122]{--brand-8: #2d4065;--brand-7: #5e94ff;--brand-6: #4c88ff;--brand-5: #2e65d1;--brand-4: #365491;--brand-3: #2d4066;--brand-2: #293650;--brand-1: #242b3a;--line-4: #3d3d3d;--line-3: #46494d;--line-2: #3f4042;--line-1: #37393b;--fill-11: #46494d;--fill-10: #292a2d;--fill-9: #202124;--fill-8: #e1e3e5;--fill-7: #9aa0a6;--fill-6: #7b7f85;--fill-5: #606367;--fill-4: #46494d;--fill-3: #3a3b3d;--fill-2: #2f3033;--fill-1: #191a1c;--opacity-6-success-3: rgba(38, 80, 65, .6);--opacity-6-brand-3: rgba(45, 64, 102, .6);--opacity-6-text-5: rgba(225, 227, 229, .6);--text-6: #686b70;--text-5: #e1e3e5;--text-4: #afb5bd;--text-3: #9a9fa6;--text-2: #686b70;--text-1: #4c4e52;--success-7: #59c999;--success-6: #47c38e;--success-5: #3b926e;--success-4: #337259;--success-3: #265041;--success-2: #284139;--success-1: #24312f;--warning-7: #feb06b;--warning-6: #fea75b;--warning-5: #bb7f4a;--warning-4: #8f643f;--warning-3: #634935;--warning-2: #4c3c2f;--warning-1: #362e29;--error-7: #ee7474;--error-6: #ec6565;--error-5: #af5151;--error-4: #864344;--error-3: #5d3537;--error-2: #492f31;--error-1: #34282a;--o-1: #8f643f;--o-2: #bb7f4a;--y-1: #635535;--y-2: #8f783f;--theme-basic: var(--fill-9);--input-bg: var(--fill-9);--input-bg-dialog: var(--fill-10);--brand-hint: #293650;--searchHistoryHover: #33466c;--sidebar-hover-selected: var(--fill-2);--dialog-box-shadow: 0 1px 16px 0 rgba(154, 154, 154, .4);--file-selector-hover-bg: rgba(0, 0, 0, .08);--file-selector-selected-bg: rgba(0, 0, 0, .08)}}.theme-dark[_ngcontent-iyk-c122]{--theme-basic: var(--fill-9);--input-bg: var(--fill-9);--input-bg-dialog: var(--fill-10);--brand-hint: #293650;--searchHistoryHover: #33466c;--sidebar-hover-selected: var(--fill-2);--dialog-box-shadow: 0 1px 16px 0 rgba(154, 154, 154, .4);--file-selector-hover-bg: rgba(0, 0, 0, .08);--file-selector-selected-bg: rgba(0, 0, 0, .08)}.theme-light[_ngcontent-iyk-c122]{--brand-8: #ebf0ff;--brand-7: #326cfe;--brand-6: #5b89fe;--brand-5: #7098fe;--brand-4: #98b5fe;--brand-3: #c2d3ff;--brand-2: #ebf0ff;--brand-1: #f5f8ff;--line-4: #e1e6ed;--line-3: #e1e6ed;--line-2: #eceff4;--line-1: #f0f3f5;--fill-11: #ffffff;--fill-10: #ffffff;--fill-9: #ffffff;--fill-8: #37435c;--fill-7: #626e85;--fill-6: #939cad;--fill-5: #c0c8d6;--fill-4: #e1e6ed;--fill-3: #f0f3f5;--fill-2: #f4f6f7;--fill-1: #f9fafb;--text-6: #c0c8d6;--text-5: #232d47;--text-4: #4e5a70;--text-3: #7a8599;--text-2: #a9b2c2;--text-1: #c0c8d6;--opacity-6-success-3: rgba(195, 236, 218, .6);--opacity-6-brand-3: rgba(194, 211, 255, .6);--opacity-6-text-5: rgba(35, 45, 71, .6);--success-7: #2b996a;--success-6: #36bf84;--success-5: #72d2a9;--success-4: #9adfc1;--success-3: #c3ecda;--success-2: #ebf9f3;--success-1: #f5fcf9;--warning-7: #cb7428;--warning-6: #fe9132;--warning-5: #feb270;--warning-4: #fec898;--warning-3: #ffdec2;--warning-2: #fff4eb;--warning-1: #fffaf5;--error-7: #bb4343;--error-6: #e95454;--error-5: #f08787;--error-4: #f4aaaa;--error-3: #f9cccc;--error-2: #fdeeee;--error-1: #fef6f6;--o-1: #ffdec2;--o-2: #fec898;--y-1: #ffedc2;--y-2: #fee298}html[_ngcontent-iyk-c122]{--brand-8: #ebf0ff;--brand-7: #326cfe;--brand-6: #5b89fe;--brand-5: #7098fe;--brand-4: #98b5fe;--brand-3: #c2d3ff;--brand-2: #ebf0ff;--brand-1: #f5f8ff;--line-4: #e1e6ed;--line-3: #e1e6ed;--line-2: #eceff4;--line-1: #f0f3f5;--fill-11: #ffffff;--fill-10: #ffffff;--fill-9: #ffffff;--fill-8: #37435c;--fill-7: #626e85;--fill-6: #939cad;--fill-5: #c0c8d6;--fill-4: #e1e6ed;--fill-3: #f0f3f5;--fill-2: #f4f6f7;--fill-1: #f9fafb;--text-6: #c0c8d6;--text-5: #232d47;--text-4: #4e5a70;--text-3: #7a8599;--text-2: #a9b2c2;--text-1: #c0c8d6;--opacity-6-success-3: rgba(195, 236, 218, .6);--opacity-6-brand-3: rgba(194, 211, 255, .6);--opacity-6-text-5: rgba(35, 45, 71, .6);--success-7: #2b996a;--success-6: #36bf84;--success-5: #72d2a9;--success-4: #9adfc1;--success-3: #c3ecda;--success-2: #ebf9f3;--success-1: #f5fcf9;--warning-7: #cb7428;--warning-6: #fe9132;--warning-5: #feb270;--warning-4: #fec898;--warning-3: #ffdec2;--warning-2: #fff4eb;--warning-1: #fffaf5;--error-7: #bb4343;--error-6: #e95454;--error-5: #f08787;--error-4: #f4aaaa;--error-3: #f9cccc;--error-2: #fdeeee;--error-1: #fef6f6;--o-1: #ffdec2;--o-2: #fec898;--y-1: #ffedc2;--y-2: #fee298;--theme-basic: #ffffff;--input-bg: #ffffff;--input-bg-dialog: #ffffff;--brand-hint: var(--brand-2);--searchHistoryHover: #cedcff;--sidebar-hover-selected: var(--fill-3);--dialog-box-shadow: 0 1px 16px 0 rgba(154, 154, 154, .4);--file-selector-hover-bg: rgba(0, 0, 0, .08);--file-selector-selected-bg: rgba(0, 0, 0, .08)}@media (prefers-color-scheme: light){.theme-system[_ngcontent-iyk-c122]{--brand-8: #ebf0ff;--brand-7: #326cfe;--brand-6: #5b89fe;--brand-5: #7098fe;--brand-4: #98b5fe;--brand-3: #c2d3ff;--brand-2: #ebf0ff;--brand-1: #f5f8ff;--line-4: #e1e6ed;--line-3: #e1e6ed;--line-2: #eceff4;--line-1: #f0f3f5;--fill-11: #ffffff;--fill-10: #ffffff;--fill-9: #ffffff;--fill-8: #37435c;--fill-7: #626e85;--fill-6: #939cad;--fill-5: #c0c8d6;--fill-4: #e1e6ed;--fill-3: #f0f3f5;--fill-2: #f4f6f7;--fill-1: #f9fafb;--text-6: #c0c8d6;--text-5: #232d47;--text-4: #4e5a70;--text-3: #7a8599;--text-2: #a9b2c2;--text-1: #c0c8d6;--opacity-6-success-3: rgba(195, 236, 218, .6);--opacity-6-brand-3: rgba(194, 211, 255, .6);--opacity-6-text-5: rgba(35, 45, 71, .6);--success-7: #2b996a;--success-6: #36bf84;--success-5: #72d2a9;--success-4: #9adfc1;--success-3: #c3ecda;--success-2: #ebf9f3;--success-1: #f5fcf9;--warning-7: #cb7428;--warning-6: #fe9132;--warning-5: #feb270;--warning-4: #fec898;--warning-3: #ffdec2;--warning-2: #fff4eb;--warning-1: #fffaf5;--error-7: #bb4343;--error-6: #e95454;--error-5: #f08787;--error-4: #f4aaaa;--error-3: #f9cccc;--error-2: #fdeeee;--error-1: #fef6f6;--o-1: #ffdec2;--o-2: #fec898;--y-1: #ffedc2;--y-2: #fee298;--theme-basic: #ffffff;--input-bg: #ffffff;--input-bg-dialog: #ffffff;--brand-hint: var(--brand-2);--searchHistoryHover: #cedcff;--sidebar-hover-selected: var(--fill-3);--dialog-box-shadow: 0 1px 16px 0 rgba(154, 154, 154, .4);--file-selector-hover-bg: rgba(0, 0, 0, .08);--file-selector-selected-bg: rgba(0, 0, 0, .08)}}.theme-light[_ngcontent-iyk-c122]{--theme-basic: #ffffff;--input-bg: #ffffff;--input-bg-dialog: #ffffff;--brand-hint: var(--brand-2);--searchHistoryHover: #cedcff;--sidebar-hover-selected: var(--fill-3);--dialog-box-shadow: 0 1px 16px 0 rgba(154, 154, 154, .4);--file-selector-hover-bg: rgba(0, 0, 0, .08);--file-selector-selected-bg: rgba(0, 0, 0, .08)}.ynote-banner-wrap[_ngcontent-iyk-c122]{height:36px}.ynote-banner-wrap[_ngcontent-iyk-c122]   .ynote-banner[_ngcontent-iyk-c122]{display:flex;align-items:center;justify-content:center;height:100%;position:relative;cursor:pointer}.ynote-banner-wrap[_ngcontent-iyk-c122]   .ynote-banner[_ngcontent-iyk-c122]   .ynote-type[_ngcontent-iyk-c122]{width:32px;height:16px;color:transparent}.ynote-banner-wrap[_ngcontent-iyk-c122]   .ynote-banner[_ngcontent-iyk-c122]   .ynote-close[_ngcontent-iyk-c122]{width:16px;height:16px;position:absolute;top:50%;transform:translateY(-50%);right:24px}.ynote-banner-wrap[_ngcontent-iyk-c122]   .ynote-banner[_ngcontent-iyk-c122]   img[_ngcontent-iyk-c122]{height:100%}.ynote-list-wrap[_ngcontent-iyk-c122]{display:flex;flex-direction:column;height:100px;margin:0 20px;box-sizing:border-box;border-bottom:1px solid #f0f3f5;border-bottom:1px solid var(--fill-3);cursor:pointer}.ynote-list-wrap[_ngcontent-iyk-c122]   .ynote-title-wrap[_ngcontent-iyk-c122]{display:flex;align-items:center}.ynote-list-wrap[_ngcontent-iyk-c122]   .ynote-title-wrap[_ngcontent-iyk-c122]   .icon[_ngcontent-iyk-c122]{width:16px;height:16px;border-radius:50%}.ynote-list-wrap[_ngcontent-iyk-c122]   .ynote-title-wrap[_ngcontent-iyk-c122]   .ynote-title[_ngcontent-iyk-c122]{flex:1;margin-left:8px;margin-right:20px;font-weight:500;font-size:14px;line-height:22px;color:#232d47;color:var(--text-5);overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.ynote-list-wrap[_ngcontent-iyk-c122]   .ynote-title-wrap[_ngcontent-iyk-c122]   .ynote-close[_ngcontent-iyk-c122]{width:12px;height:12px;margin-left:2px}.ynote-list-wrap[_ngcontent-iyk-c122]   .ynote-title-wrap[_ngcontent-iyk-c122]   .ynote-close[_ngcontent-iyk-c122]   svg[_ngcontent-iyk-c122]{display:block!important}.ynote-list-wrap[_ngcontent-iyk-c122]   .ynote-list-content[_ngcontent-iyk-c122]{display:flex;flex:1;overflow:hidden;flex-direction:column}.ynote-list-wrap[_ngcontent-iyk-c122]   .ynote-list-content[_ngcontent-iyk-c122]   .ynote-content[_ngcontent-iyk-c122]{display:flex;margin-top:4px}.ynote-list-wrap[_ngcontent-iyk-c122]   .ynote-list-content[_ngcontent-iyk-c122]   .ynote-content[_ngcontent-iyk-c122]   .ynote-desc[_ngcontent-iyk-c122]{flex:1;height:40px;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;font-size:12px;line-height:20px;color:#7a8599;color:var(--text-3)}.ynote-list-wrap[_ngcontent-iyk-c122]   .ynote-list-content[_ngcontent-iyk-c122]   .ynote-content[_ngcontent-iyk-c122]   .content-image[_ngcontent-iyk-c122]{width:54px;height:40px;margin-left:8px;-o-object-fit:cover;object-fit:cover;-o-object-position:0 0;object-position:0 0;border-radius:2px}.ynote-list-wrap[_ngcontent-iyk-c122]   .ynote-list-content[_ngcontent-iyk-c122]   .ynote-btn[_ngcontent-iyk-c122]{display:flex;align-items:center;justify-content:space-between;margin-top:4px}.ynote-list-wrap[_ngcontent-iyk-c122]   .ynote-list-content[_ngcontent-iyk-c122]   .ynote-btn[_ngcontent-iyk-c122]   span[_ngcontent-iyk-c122]{height:20px;padding:0 4px;background:#f0f3f5;background:var(--fill-3);border-radius:2px;font-size:12px;line-height:20px;text-align:center;color:#5b89fe;color:var(--brand-6)}.ynote-list-wrap[_ngcontent-iyk-c122]   .ynote-list-content[_ngcontent-iyk-c122]   .ynote-btn[_ngcontent-iyk-c122]   .ynote-type[_ngcontent-iyk-c122]{width:32px;height:16px;color:transparent}.ynote-screen-wrap[_ngcontent-iyk-c122]{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.3);z-index:9999}.ynote-screen-wrap[_ngcontent-iyk-c122]   .ynote-screen-content[_ngcontent-iyk-c122]{width:600px;height:340px;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);cursor:pointer;border-radius:4px}.ynote-screen-wrap[_ngcontent-iyk-c122]   .ynote-type[_ngcontent-iyk-c122]{position:absolute;width:36px;height:18px;left:0;bottom:0;color:transparent}.ynote-screen-wrap[_ngcontent-iyk-c122]   .ynote-close[_ngcontent-iyk-c122]{position:absolute;width:20px;height:20px;right:12px;top:12px}</style>
<style>.widget-dialog[_ngcontent-iyk-c27] {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        z-index: 10001;
        visibility: hidden;
    }
    .widget-dialog-container[_ngcontent-iyk-c27] {
        min-width: 250px;
    }</style>
</head>
<body>
<div yne-bulb-block="paragraph" style="white-space: pre-wrap;"><span style="font-size:20px;font-family:helvetica;color:#464646;">PHP程序注入漏洞详解</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">注入，可以理解就是把用户可控的一些变量，带入到数据库操作当中，并且造成改变sql原意的效果。譬如注册用户的逻辑中，检测用户名是否存在的时候，把用户提交过来的用户名拿到数据库中去查询。如果代码逻辑中没有对用户名做好过滤的话，用户就可以提交一些特殊字符来完成注入。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">根据sql分类，注入一般分四种类型：</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">select</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">update</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">insert</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">delete</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">如果有mysql&nbsp;error的话，这四种都能用报错注入，非常方便;如果没有mysql&nbsp;error</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">select的注入：可以试下用union&nbsp;select+回显来注入，如果没有回显，那就只能够用盲注了。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">update的注入：如果是在update&nbsp;set的位置的话，那么我们可以找找这个表的哪个column会被展示出来。例如如果一个update的注入点是在用户表且是在set位置可控的话，那么&nbsp;我们可以update&nbsp;email这个column，然后去用户资料看一下自己的email就出数据了，语句例如update&nbsp;table&nbsp;set&nbsp;email=(select&nbsp;user());如果是在where后的话，那么一般也就是盲注了。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">insert的注入：一般也是通过找哪个column会不会显示出来，尽量把要出的数据插入到这个column里面去。&nbsp;如果没显示的话，也是盲注。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">delete的注入：一般都是盲注了。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">数字型注入主要就是因为他的变量并没有用</span><a href="bytedance://keywords/?keyword=单引号&amp;index=2"><span style="font-size:18px;font-family:helvetica;color:#3c6598;">单引号</span></a><span style="font-size:18px;font-family:helvetica;color:#464646;">引住。但是基本上都是被强制类型转换了，譬如intval($username)啥的。但是有时候会有遗漏的嘛。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">而字符型和搜索型的，都是会有单引号引住的。所以需要闭合单引号再来进行注入。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">说到单引号不得不说个php.ini里的配置Magic_quotes_gpc，在稍微高点的版本默认都是on，但是却在5.4就已经废除了。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">从字面意思上来看，就是对GPC&nbsp;QUOTE嘛。GPC对应的就是GET、POST和COOKIE，其中的内容，会被</span><a href="bytedance://keywords/?keyword=转义&amp;index=0"><span style="font-size:18px;font-family:helvetica;color:#3c6598;">转义</span></a><span style="font-size:18px;font-family:helvetica;color:#464646;">的字符为&nbsp;'&nbsp;“&nbsp;\&nbsp;NULL，转义的方式是在前面添加上一个转义符。从而导致了失去本来的意义，无法闭合单引号进行注入。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">全局没有做addslashes的</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">像这种全局没有对GET/POST/COOKIE做addslashes的，这种厂商基本是会在查询的时候，再对一些用户可控的变量进行addslashes，甚至是不进行addslashes直接带入查询的。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">这样的就算在查询的时候进行addslashes，在很多时候也都能找到几处遗漏了addslashes的。这种的比较简单，不多说。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">全局做addslashes</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">现在稍微好一点的厂商都知道了在全局文件中对GET/POST/COOKIE做addslashes&nbsp;(甚至是在带入查询的函数中再做了转义或者预编译，这种给跪)&nbsp;所以基本不用担心哪里遗漏了哪里忘记了addslashes)&nbsp;这种的基本是首先先get&nbsp;magic&nbsp;quotes&nbsp;gpc&nbsp;判断gpc是否开启，如果没开启的话，再调用addslashes来转义。如果开启的话，就不用来addslashes了。没开启就&nbsp;addslashes。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">下面讲一些常见的注入方式</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">宽字节注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">这个是一个老生常谈的问题,&nbsp;从一开始的数据库</span><a href="bytedance://keywords/?keyword=字符集&amp;index=4"><span style="font-size:18px;font-family:helvetica;color:#3c6598;">字符集</span></a><span style="font-size:18px;font-family:helvetica;color:#464646;">GBK的宽字节注入，到现在也有很久了。但是并不是字符集为GBK的就能宽字节注入。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">总有一些小伙伴说咋我看的cms字符集是gbk的，但是咋不能宽字节呢？</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">这是因为数据库的连接方式不同。数据库连接的时候，使用了Set&nbsp;names&nbsp;gbk这样的就能宽字节。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">但是现在这样的基本都看不到了。因为基本都是设置了二进制读取了。这样的宽字节基本没了,&nbsp;却有了另外一种，因为转换字符集造成的宽字节注入。譬如从utf8转到gbk，或者从gbk转到utf8什么的。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;74cms&nbsp;最新版&nbsp;注入8-9</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">解析：“錦”字，从UTF8转成GBK之后成了&nbsp;%e5%5c 74，cms对GET/POST/COOKIE等都做了addslashes ，所以'转义后为\' -&gt;%5C&nbsp;%e5%5c%5c'&nbsp;两个\，则单引号出来了。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子2:&nbsp;WooYun:&nbsp;qibocms&nbsp;下载系统</span><a href="bytedance://keywords/?keyword=SQL注入&amp;index=3"><span style="font-size:18px;font-family:helvetica;color:#3c6598;">SQL注入</span></a><span style="font-size:18px;font-family:helvetica;color:#464646;">一枚(官网可重现)</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">解码导致注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">因为在全局文件中addslashes，如果我们能找到一些解码的，例如urldecode、base64_decode之类的，那么我们先提交encode之后的，那么就能不被转义了。然后decode后，再带入查询，造成了注入，无视gpc。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">这种的很常见。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子很多&nbsp;随便找一个</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;qibocms&nbsp;B2b&nbsp;注入一枚&nbsp;//qibocms&nbsp;注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;phpdisk&nbsp;V7&nbsp;sql注入2&nbsp;//phpdisk&nbsp;注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">变量覆盖导致的注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">常见的变量覆盖&nbsp;有啥extract&nbsp;和&nbsp;parse_str&nbsp;函数啥的，当然还有$$。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">变量覆盖得结合一些具体的场景了。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例如extract($_POST)啥的，直接从POST数组中取出变量。这样的还是遇到过几个，然后覆盖掉之前的一些变量。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">覆盖的话，一般是覆盖掉表前缀之类的。譬如Select&nbsp;*&nbsp;from&nbsp;$pre_admin&nbsp;where&nbsp;xxx像这种的就覆盖掉$pre，然后直接补全语句然后注入。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;qibocms分类注入一枚可提升自己为管理</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子2:&nbsp;WooYun:&nbsp;phpmps&nbsp;注入一枚</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">当然&nbsp;$$&nbsp;也挺经常用到的&nbsp;这个例子很不错。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子3:&nbsp;WooYun:&nbsp;MetInfo最新版(5.2.4)一处SQL盲注漏洞</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">一些replace造成的注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">一些cms中，总有一些逗比过滤函数，譬如会把’&nbsp;啥的replace成空，但是他似乎忘记了自己全局有转义。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">这时，当用户提交一个'，全局转义成\'，然后这过滤函数又会把'替换成空，那么就留下了\，导致可以吃掉一个单引号，是double&nbsp;query的话</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">select&nbsp;*&nbsp;from&nbsp;c_admin&nbsp;where&nbsp;username=’admin\’&nbsp;and&nbsp;email=’inject#’</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">这样就可以注入了。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;PHPCMS全版本通杀SQL注入漏洞</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">当然还有一些replace是用户可控的。就是说用户可以想把啥提交成空就提交成空，例如很久前的cmseasy和ecshop的那个注入。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例如这段代码：</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">$order_sn&nbsp;=&nbsp;str_replace($_GET['subject'],'',$_GET['out_trade_no']);</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">这里因为会被转义，如果提交'就成&nbsp;\'，这里可以看到，这里清成空的，是我们get来的，那我们就想办法把\给replace掉。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">但是如果我们GET提交把\给replace，那么会被转义，就是replace掉\。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">但是我们只是\'，所以不能把\去掉，如果我有\，还要你清空个毛啊。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">这里我们来理清一下思路：</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">Addslashes&nbsp;会对'&nbsp;"&nbsp;\&nbsp;NULL&nbsp;转义</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">'&nbsp;=&gt;&nbsp;\'"&nbsp;=&gt;&nbsp;\"\&nbsp;=&gt;&nbsp;\\NULL&nbsp;=&gt;&nbsp;\0</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">那这里我们就提交%00’，就会被转义生成&nbsp;\0\'&nbsp;，这时候我们再提交把0替换成空，那么就成了\'，单引号也就成功出来了。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;cmseasy绕过补丁SQL注入一枚</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">SERVER未转义导致的注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">因为在很多cms中，基本上都只是对GET&nbsp;POST&nbsp;COOKIE&nbsp;进行addslashes，而没有对SERVER进行转义。而一些SERVER的变量也是用户可以控制的。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例如什么&nbsp;QUERY_STRING&nbsp;X_FORWARDED_FOR&nbsp;CLIENT_IP&nbsp;HTTP_HOST&nbsp;ACCEPT_LANGUAGE&nbsp;很多。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">这里最常见的当然也就是X_FORWARDED_FOR，这个一般是在ip函数中用到。如果后面没有进行验证ip是否合法的话就直接return，这个大部分时候都会导致注入。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子1:&nbsp;WooYun:&nbsp;Phpyun注入漏洞二</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">这里说到验证ip，这里基本都是用的正则来验证是否合法。而一些厂商连正则都写错。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例如在cmseasy中的验证ip的正则中(%.+)，导致了后面可以写任意字符。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子2:&nbsp;WooYun:&nbsp;CmsEasy最新版本无限制SQL注射</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">FILES未转义导致的注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">这个也差不多，也是因为全局只对COOKIE&nbsp;GET&nbsp;POST&nbsp;转义，遗漏了FILES，且不受gpc。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">FILES注入一般是因为上传，会把上传的名字带到insert当中入库。然后这里文件的名字是我们可以控制的，所以导致了注入。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;qibocms&nbsp;黄页系统SQL注入一枚</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">还有一些，在入库的时候才对文件的名字进行了转义，而在获取后缀后，在入库的时候对文件名转义了却没有对后缀转义也导致了注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;Supesite&nbsp;前台注入&nbsp;#2&nbsp;(Insert)</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">未</span><a href="bytedance://keywords/?keyword=初始化&amp;index=1"><span style="font-size:18px;font-family:helvetica;color:#3c6598;">初始化</span></a><span style="font-size:18px;font-family:helvetica;color:#464646;">造成的注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">很久以前php&lt;4.20的时候，为了方便，register_globals默认都是on。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">而到了后面register_globals的弊端也显现了出来,&nbsp;所以也在很久以前默认都是off了。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">而到了现在,&nbsp;很多cms却喜欢模仿register_globals&nbsp;搞起了伪全局机制。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例如啥qibocms&nbsp;metinfo&nbsp;destoon&nbsp;啥的啊。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">这样是方便了不少,&nbsp;但是如果哪里遗漏了初始化，那么就会导致注入了。感觉这种的挺好玩的&nbsp;多找了几个例子。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;qibocms地方门户系统注入一个问题(demo测试)</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;qibocms地方门户系统注入(多处类似,demo测试)</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;齐博地方门户系统SQL注入漏洞(无需登录可批量)</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;齐博整站/地方门户SQL注入漏洞</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">数组中的key导致的注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">因为在对全局转义的时候，很多cms都只是判断gpc是否开启，如果off，就对数组中的value就行addslashes，却忘记了对数组中的key进行转义。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">那么这样也导致了一个问题。也就是在Gpc&nbsp;off的时候那么数组的key没有被过滤，导致可以引入单引号。(听说低版本的php对二维数组中的key就算gpc&nbsp;on&nbsp;也不会转义)</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">如果哪里把数组中的key，读取出来，然后把key带入到了查询当中，那么也会造成安全问题。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">而且这样的例子很多。&nbsp;简直惨不忍睹。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;qibocms&nbsp;V7&nbsp;整站系统最新版SQL注入一枚&nbsp;&amp;&nbsp;另外一处能引入转义符的地方。&nbsp;//数组key的注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;qibocms多个系统绕过补丁继续注入2</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;qibocms全部开源系统&nbsp;Getshell</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;Discuz&nbsp;5.x&nbsp;6.x&nbsp;7.x&nbsp;前台SQL注入漏洞一枚</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">offset造成的注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">这种算是比较常见的一种注入的。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">代码大概如下：</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">如果这里$_GET[a]&nbsp;提交的是一个数组，且含有一个key为0的，那么$a就是对应的这个key的value。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">但是这里并没有强制要求为数组。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">那么我们提交一个字符串，那么后面的[0]就是截取的第一个字符。在全局中，单引号被转义为\'，截取第一个字符就为了\。\会吃掉一个单引号，然后就在$b处写入inject可以注入了。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;qibocms&nbsp;地方门户系统&nbsp;注入#4(demo测试)</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">还有map发的那Disucz&nbsp;7.2的那注入也一样。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">第三方插件导致的注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">很常见的一种洞。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">比较常见的uc和alipay&nbsp;tenpay&nbsp;chinabank&nbsp;啥的特别是uc，因为默认uc里面都会striplashes</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">Uc的话，一般会遇到的问题是uckey默认的。或者是uckey这个常量根本就没有初始化，导致了uckey可控，再导致了Getshell或者注入啥的。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">还有tenpay&nbsp;和&nbsp;alipay&nbsp;啥的，一些是因为忘记把过滤的文件包含进来，且key默认是空的，导致可以通过验证。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;phpmps&nbsp;注入&nbsp;(可修改其他用户密码,官网成功)&nbsp;//&nbsp;phpmps&nbsp;uc致注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;PHPEMS&nbsp;(在线考试系统)&nbsp;设计缺陷&nbsp;Getshell一枚(官网已shell)&nbsp;/phpems&nbsp;uc致getshell</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;最土团购注入一枚可直接提升自己为管理&nbsp;&amp;&nbsp;无限刷钱。&nbsp;//最土团购&nbsp;chinabank致注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;Destoon&nbsp;Sql注入漏洞2(有条件)&nbsp;//destoon&nbsp;tenpay致注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;CSDJCMS程式舞曲最新版Sql&nbsp;一枚&nbsp;//csdj&nbsp;tenpay致注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">数字型注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">其实也不只是数字型，只是说一些忘记加单引号的地方都这样。这里只是一般数字型的都不会加单引号的。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">一般的是这样：</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">$id=$_GET[id];Select&nbsp;*&nbsp;from&nbsp;table&nbsp;where&nbsp;id=$id;</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">$id，没被单引号，且没有被强制类型转换，那么就算addslashes了，由于不需要去闭合单引号，所以也无影响。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;qibocms&nbsp;地方门户系统&nbsp;注入#3&nbsp;(demo测试)</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">并不是一些数字型,一些其他的点也有些忘记加单引号，导致了注入。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;Supesite&nbsp;前台注入&nbsp;#3&nbsp;(Delete)</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">二次注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">也是一种比较常见的注入。涉及到的是入库和出库。因为有全局转义，然后入库的时候</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">insert&nbsp;into&nbsp;table&nbsp;(username)&nbsp;values&nbsp;('a\'');</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">这样入库后，转义符就会消失，那么就是a'。如果哪里再把这个查询出来，那么也就是出库的是a'，如果再把出库的&nbsp;再带入到了查询啥的，那么就再次成功的引入了单引号导致了注入。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;phpyun&nbsp;v3.2&nbsp;(20141226)&nbsp;两处注入。</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;qibocms&nbsp;地方门户系统&nbsp;二次注入#5(demo测试)</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;74cms&nbsp;(20140709)&nbsp;二枚二次注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例子:&nbsp;WooYun:&nbsp;Hdwiki最新版二次注入一枚</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">截取字符导致的注入</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">有些cms有的时候会限制用户输入的长度，所以只截取一部分</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">例如uchome的cutstr($asd,32);</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">这样只允许输入32个字符，而且uchome里面的这个也没有像dz那样截取字符的后面加...</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">那么如果我们提交一个1111111111111111111111111111111’</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">被转义后成1111111111111111111111111111111\’</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">然后截取32个字符，就是1111111111111111111111111111111\</span></div><div yne-bulb-block="paragraph" style="white-space: pre-wrap;text-align:justify;"><span style="font-size:18px;font-family:helvetica;color:#464646;">如果又是double&nbsp;query的话，吃掉一个单引号，然后下一个连着的可控变量又可以注入了</span></div>
</body>